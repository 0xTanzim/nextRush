name: ğŸ› ï¸ Development Workflow

on:
  push:
    branches: [ feat/*, dev/*, fix/* ]
  workflow_dispatch:

jobs:
  # ğŸš€ Quick Development Checks
  dev-check:
    name: ğŸš€ Quick Dev Check
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¥ Checkout Repository
        uses: actions/checkout@v4

      - name: ğŸ“¦ Setup pnpm
        uses: pnpm/action-setup@v3
        with:
          version: 8

      - name: ğŸŸ¢ Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 20
          cache: 'pnpm'

      - name: ğŸ“¦ Install Dependencies
        run: pnpm install --frozen-lockfile

      - name: ğŸ—ï¸ Build Check
        run: pnpm build

      - name: ğŸ§ª Quick Test
        run: pnpm test --run

      - name: ğŸ” Lint Check
        run: pnpm lint

      - name: âš¡ Performance Check
        run: |
          cd benchmarks
          pnpm install
          pnpm bench:quick || echo "âš ï¸ Performance check completed with warnings"

  # ğŸ” Security Scan
  security:
    name: ğŸ”’ Security Scan
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¥ Checkout Repository
        uses: actions/checkout@v4

      - name: ğŸ“¦ Setup pnpm
        uses: pnpm/action-setup@v3
        with:
          version: 8

      - name: ğŸŸ¢ Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 20
          cache: 'pnpm'

      - name: ğŸ“¦ Install Dependencies
        run: pnpm install --frozen-lockfile

      - name: ğŸ”’ Run Security Audit
        run: pnpm audit

      - name: ğŸ›¡ï¸ Check for Vulnerabilities
        run: |
          pnpm audit --audit-level moderate || echo "âš ï¸ Security audit completed with warnings"
